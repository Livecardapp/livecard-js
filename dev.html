<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- LiveCard dependencies -->
  <link rel="stylesheet" href="/livecard.css">
  <script src="/livecard.sdk.js"></script>
  <!-- LiveCard dependencies -->

  <title>Checkout</title>

  <script type="text/javascript">
    LiveCard.licenseKey = "zeGBS3PiwkhBSpn-JDbz";
    let lastView = 0;

    function createVideoMessage() {
      LiveCard.startVideoRecording({
        showIntro: true, //Client can opt out of showing our intro by passing false here
        onSuccess: function () {
          collectPhoneNumber();
        },
        onFailure: function (errorCode) {
          console.log('startVideoRecording failure: ' + errorCode);
          if (errorCode === LiveCardError.RECORDING_NOT_SUPPORTED) {
            //Client can show own UI for case of webcam recording not supported and expose some UI to choose a file from hd, which triggers LiveCard.selectVideoFile()
            //Or can use our own modal as here
            setTimeout(function () {
              //LiveCard.showRecordingNotSupported();
              console.log('not supported')
            }, 400);
          }
        }
      });
    }


    function createGiftMessage() {
      lastView = 1;
      LiveCard.showGiftTextInput({
        showIntro: true, //Client can opt out of showing our intro by passing false here
        onSuccess: () => {
          collectPhoneNumber();
        }
      });
    }

    function createImageMessage() {
      lastView = 2;
      LiveCard.showImageInput({
        onFailure: () => {
          console.log('failed image');
        },
        onSuccess: () => {
          collectPhoneNumber();
        }
      });
    }

    function collectPhoneNumber() {
      //Client can collect phone with own UI and set directly like here or use our modal as below
      //LiveCard.recipientPhone = '1234567890';
      LiveCard.showPhoneInput({
        onBack: () => {
          switch (lastView) {
            case 1:
              createGiftMessage();
              break;
            case 2:
              createImageMessage();
              break;
            default:
              break;
          }
        },
        onSuccess: () => {
          //update UI if needed
        }
      });
    }
  </script>

</head>

<body>
  <button onclick="createVideoMessage()">Create Video Message</button><br><br>
  <button onclick="createGiftMessage()">Create Gift Message</button><br><br>
  <button onclick="createImageMessage()">Create Image Message</button><br><br>
</body>

</html>